{"version":3,"file":"copy_runtime.js","sources":["../src/api/utils/validate_bundler.ts","../src/api/utils/copy_shimport.ts","../src/core/read_template.ts","../src/api/utils/copy_runtime.ts"],"sourcesContent":["import * as fs from 'fs';\n\nexport default function validate_bundler(bundler?: 'rollup' | 'webpack') {\n\tif (!bundler) {\n\t\tbundler = (\n\t\t\tfs.existsSync('rollup.config.js') || fs.existsSync('rollup.config.ts') ? 'rollup' :\n\t\t\tfs.existsSync('webpack.config.js') || fs.existsSync('webpack.config.ts') ? 'webpack' : null\n\t\t);\n\n\t\tif (!bundler) {\n\t\t\t// TODO remove in a future version\n\t\t\tdeprecate_dir('rollup');\n\t\t\tdeprecate_dir('webpack');\n\n\t\t\tthrow new Error(`Could not find a configuration file for rollup or webpack`);\n\t\t}\n\t}\n\n\tif (bundler !== 'rollup' && bundler !== 'webpack') {\n\t\tthrow new Error(`'${bundler}' is not a valid option for --bundler â€” must be either 'rollup' or 'webpack'`);\n\t}\n\n\treturn bundler;\n}\n\nfunction deprecate_dir(bundler: 'rollup' | 'webpack') {\n\ttry {\n\t\tconst stats = fs.statSync(bundler);\n\t\tif (!stats.isDirectory()) return;\n\t} catch (err) {\n\t\t// do nothing\n\t\treturn;\n\t}\n\n\t// TODO link to docs, once those docs exist\n\tthrow new Error(`As of Sapper 0.21, build configuration should be placed in a single ${bundler}.config.js file`);\n}\n","import * as fs from 'fs';\n\nexport function copy_shimport(dest: string) {\n\tconst shimport_version = require('shimport/package.json').version;\n\tfs.writeFileSync(\n\t\t`${dest}/client/shimport@${shimport_version}.js`,\n\t\tfs.readFileSync(require.resolve('shimport/index.js'))\n\t);\n}","import * as fs from 'fs';\n\nexport default function read_template(dir: string) {\n\ttry {\n\t\treturn fs.readFileSync(`${dir}/template.html`, 'utf-8');\n\t} catch (err) {\n\t\tif (fs.existsSync(`app/template.html`)) {\n\t\t\tthrow new Error(`As of Sapper 0.21, the default folder structure has been changed:\n  app/    --> src/\n  routes/ --> src/routes/\n  assets/ --> static/`);\n\t\t}\n\n\t\tthrow err;\n\t}\n}","import * as fs from 'fs';\nimport * as path from 'path';\nimport { mkdirp } from './fs_utils';\n\nconst runtime = [\n\t'app.mjs',\n\t'server.mjs',\n\t'internal/shared.mjs',\n\t'internal/layout.svelte',\n\t'internal/error.svelte'\n].map(file => ({\n\tfile,\n\tsource: fs.readFileSync(path.join(__dirname, `../runtime/${file}`), 'utf-8')\n}));\n\nexport function copy_runtime(output: string) {\n\truntime.forEach(({ file, source }) => {\n\t\tmkdirp(path.dirname(`${output}/${file}`));\n\t\tfs.writeFileSync(`${output}/${file}`, source);\n\t});\n}"],"names":[],"mappings":";;;;;;;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjCA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;"}